---
title: "emtesting"
output: html_document
---

We will test that the output of the e step matches the actualy computation using the test.funct.

```{r}
J=100;R=40;K=3

source('~/matrix_ash/R/sarah\'s_mixem.R')
b.j.hat=matrix(rnorm(J*R),ncol=R)
se.j.hat=matrix(rep(1,J*R),ncol=R)
factor.mat=matrix(rnorm(K*R),ncol=R)
lambda.mat=matrix(rnorm(K*J),ncol=K)

par.init=list(true.covs=init.covmat(t.stat = b.j.hat,factor.mat = factor.mat,lambda.mat = lambda.mat,K = 3,P=2),pi=rep(1/K,K))###output a list of K covariance matrices and initial pis 
par.init.unlist=unlist(par.init)
##check to make sure [K,R,R]
(dim.true.cov.fun(par.init.unlist))




###To test, set 
max.step=par.init
max.step.unlist=par.init.unlist
test.funct(j = 1,max.step.unlist = par.init.unlist,k=3,R=R)
```


